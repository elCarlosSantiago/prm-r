//Prsiam Schema Documentation https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    //for purposes of the project we will only be using one database for prod/stage/dev
    // In reality we would setup a database for each environment
    provider     = "mysql"
    url          = env("DATABASE_URL")
    relationMode = "prisma"
}

model Product {
    id            String   @id @default(cuid())
    createdAt     DateTime @default(now())
    updatedAt     DateTime @updatedAt
    name          String
    price         Decimal
    stockQuantity Int
    image         String
    category      Category @relation(fields: [categoryId], references: [id])
    categoryId    String
    Order         Order?   @relation(fields: [orderId], references: [id])
    orderId       String?

    @@index([categoryId], name: "categoryId")
    @@index([orderId], name: "orderId")
}

model Category {
    id        String    @id @default(cuid())
    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    name      String
    products  Product[]
}

model Order {
    id                String    @id @default(cuid())
    createdAt         DateTime  @default(now())
    updatedAt         DateTime  @updatedAt
    status            String
    total             Decimal
    products          Product[]
    customer          Customer  @relation(fields: [customerId], references: [id])
    trackingNumber    String
    trackingCompany   String
    shippingAddressId String
    customerId        String
    // paymentIntentId   String if implemented with stripe
    paymentMethod     String

    @@index([customerId], name: "customerId")
}

model Customer {
    id        String   @id @default(cuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    firstName String
    lastName  String
    email     String
    phone     String
    orders    Order[]
}
